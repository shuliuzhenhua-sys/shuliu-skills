---
name: ecommerce-images
description: 电商商品图生成工作流技能。接收用户提供的商品原图，按模式生成主图、详情图或两者；详情图按套生成并在执行前询问用户需要几张；默认调用 banana-proxy，失败时回退到 baoyu-image-gen；仅支持用中文风格名选择主图/详情图风格。
---

# 电商主图/详情图工作流（无脚本版）

按以下流程执行，不创建本 skill 的自定义代码脚本。

## 输入规范

- 必要输入：
  - 商品原图路径（本地文件，可作为参考图）
- 可选输入：
  - `mode`：`main` | `detail` | `both`（默认 `both`）
  - `mainStyle`：主图风格名（推荐）
  - `detailStyle`：详情图风格名（推荐）
  - `detailCount`：详情图张数（当 `mode=detail|both` 时必问，用户未给就先询问）
  - `quality`、`imageSize`、`model`（透传给生图 skill）
  - `ar`（可选覆盖；不传时使用默认比例）

## 执行顺序

1. 校验输入图片存在且可读。
2. 根据 `mode` 决定生成目标：
   - `main`：只生成主图
   - `detail`：只生成详情图套图
   - `both`：先主图后详情图套图
3. 当 `mode=detail|both` 时，先询问用户“详情图需要几张？”，得到 `detailCount` 后再执行。
4. 为每张目标图按风格名组装中文提示词。
5. 先调用 `banana-proxy` 生成：
   - 使用参考图（`--ref`）
   - 默认比例：
     - 主图：`1:1`
     - 详情图：`3:4`
   - 输出路径建议：
     - 主图：`out/ecommerce-images/<原图名>_main_<风格key>.png`
     - 详情图第 i 张：`out/ecommerce-images/<原图名>_detail_<风格key>_n<i>.png`
6. 如果 `banana-proxy` 失败，立即回退到 `baoyu-image-gen`：
   - 保持同一提示词、参考图与输出路径约定
7. 返回结构化结果，至少包含：模式、风格名、详情图数量、每张图的最终输出路径、实际使用的 provider。

## Provider 策略

- 默认：`banana-proxy`
- 回退：`baoyu-image-gen`
- 禁止反向顺序（除非用户明确要求）

## 风格选择（可扩展）

主图风格（`mainStyle`）：
- `白底极简`（默认）
- `卖点文案`
- `轻场景`

详情图风格（`detailStyle`）：
- `卖点总览`（默认）
- `参数规格`
- `场景对比`

当收到未定义风格名时，回退到默认风格，并在结果里说明已回退。

## 详情图套图规则

- `detailCount` 取值建议：`3-6` 张（可按用户要求调整）。
- 套图内每张图需要有明确分工，避免重复构图。示例分工：
  - 第1张：核心卖点总览
  - 第2张：局部特写
  - 第3张：参数/规格
  - 第4张：使用场景
  - 第5张：对比或细节补充
- 若用户只说“生成详情图”但未给数量，必须先追问数量，再开始生成。

## 提示词模板

主图 `白底极简`：

```text
基于参考图片中的商品，生成一张电商平台可用的商品主图。
要求：
1) 商品为唯一主体，完整不截断、无遮挡。
2) 使用干净白色或浅色背景，画面简洁。
3) 不添加Logo、水印、价格角标、二维码。
4) 光线均匀，突出材质与轮廓，符合主流电商审核要求。
```

详情图 `卖点总览`：

```text
基于参考图片中的商品，生成一张电商详情页模块图。
要求：
1) 以商品为主体，可展示2-3个局部特写。
2) 可添加少量简短中文卖点，排版清晰易读。
3) 背景可轻场景化，但不喧宾夺主。
4) 不添加Logo、水印、二维码或平台强绑定UI元素。
```

## 环境变量

- 走 `banana-proxy` 时：
  - `LNAPI_KEY`（必填）
- 走 `baoyu-image-gen` 回退时：
  - 建议优先 `GOOGLE_API_KEY`，或 `OPENAI_API_KEY`

## 输出约定

- `mode=main`：返回主图路径
- `mode=detail`：返回详情图路径
- `mode=both`：返回主图与详情图路径
- 详情图返回数组：`savedDetailImages[]`
- 附带每张图的 `provider`（`banana-proxy` 或 `baoyu-image-gen`）与 `styleKey`

## 面向用户的话术

- 先用自然语言确认风格，例如：
  - “主图要白底极简，还是带卖点文案？”
  - “详情图你要卖点总览、参数规格，还是场景对比？”
- 若用户说“默认风格”，则主图用 `白底极简`，详情图用 `卖点总览`。
